steps:
# Since setup_vac_min.yml also calls min.yml, if we directly pass &min.tpr to grompp in
# steep.yml, then there will be a copy of &min.tpr at each call site.
# We only want to make a reference to min.tpr after minimizing in solvent,
# (i.e. immediately before molecular dynamics) so we can extract &min.tpr
# to this level and use the following syntax to pass it to only one call site.
# (Moreover, the former will create multiple definitions of &min.tpr, which is not allowed.)
  - min.yml:
  - equil.yml:
  - prod.yml:

# Pass the CWL `in` tag as a parameter through BOTH of the yml DSL tags cg.yml and grompp.
# Use (1-based) indexing to uniquely reference (step_number, step_name).
# Put everything under one top-level wic: tag to facilitate easy merging and removal.
wic:
  graphviz:
    label: Molecular Dynamics
  steps:
    (1, min.yml):
      wic:
        steps:
          (2, cg.yml):
            wic:
              steps:
                (1, grompp):
                  in:
                    output_tpr_path: '&min.tpr'